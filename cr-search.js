!function(e){e.fn.crSearch=function(t){let n=e.extend({},{minCharsToShowMenu:3,object:[],maxResults:5,placeholderText:"Введите запрос",noResultsText:"Нет результатов",showImage:!0,useNaturalLanguage:!1,enableLinks:!1,onSelect:null,onInput:null},t);return this.each(function(){let t=e(this),i=e('<div class="suggestions-container"></div>'),a=e('<i class="clear-icon fas fa-times"></i>');t.attr("placeholder",n.placeholderText),t.after(a),a.on("click",function(){t.val("").focus(),i.empty().hide(),a.hide()}),t.on("input",function(){let l=t.val().trim();if(a.toggle(l.length>0),l.length>=n.minCharsToShowMenu){var s,o,c;let r=n.useNaturalLanguage?function e(t,n,i){let a=new Fuse(n,{keys:["text"]}),l=a.search(t);return l.map(e=>e.item).slice(0,i)}(l,n.object,n.maxResults):(s=l,o=n.object,c=n.maxResults,o.filter(function(e){return e.text.toLowerCase().includes(s.toLowerCase())}).slice(0,c));if(i.empty(),r.length>0)e.each(r,function(a,l){if(a>=n.maxResults)return!1;let s=e('<div class="suggestion"></div>');if(n.showImage&&l.imageUrl){let o=e('<img data-lazy-image_resize="true" data-lazy-image_detect="css-width">');o.attr("src",l.imageUrl),s.append(o)}let c=e('<div class="suggestion-text">'+l.text+"</div>");if(s.append(c),n.enableLinks&&l.pageUrl){let r=e('<a href="'+l.pageUrl+'"></a>');r.append(s),s=r}s.on("click",function(){n.enableLinks&&l.pageUrl||(t.val(l.text),i.empty().hide(),"function"==typeof n.onSelect&&n.onSelect(l))}),i.append(s)}),i.insertAfter(t).show();else{let u=e('<div class="no-results">'+n.noResultsText+"</div>");i.append(u),i.insertAfter(t).show()}}"function"==typeof n.onInput&&n.onInput(l)}),t.on("keyup",function(e){let n=t.val().trim();0===n.length&&8===e.keyCode&&(i.empty().hide(),a.hide())}),e(document).on("click",function(n){e(n.target).closest(".suggestions-container").length||e(n.target).is(t)||(i.empty().hide(),a.hide())})})}}(jQuery);
